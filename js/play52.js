let openjs=getUrl();if(messErr=openjs.messErr)throw messErr;const iframe=parent.iframeVideo;if(!openjs.mimeType)throw window.stop(),url=openjs.newUrl,iframe&&(window.parent.postMessage("noTest"),window.parent.postMessage({flux:" "+getDomain(url)})),window.location.replace(url),"TVRZ Play, re-location sur "+url;const errors={1:{type:"MEDIA_ERR_ABORTED",en:"The video download was cancelled",fr:"Le chargement de la vid\xe9o a \xe9t\xe9 annul\xe9"},2:{type:"MEDIA_ERR_NETWORK",en:"The video connection was lost, please confirm you are connected to the internet",fr:"La connexion a \xe9t\xe9 perdue. Assurez-vous d'\xeatre bien connect\xe9 \xe0 Internet"},3:{type:"MEDIA_ERR_DECODE",en:"The video is bad or in a format that cannot be played on your browser",fr:"La vid\xe9o est d\xe9fectueuse ou dans un format qui ne peut \xeatre jou\xe9 dans un navigateur"},4:{type:"MEDIA_ERR_SRC_NOT_SUPPORTED",en:"This video is either unavailable or not supported in this browser",fr:"Probl\xe8me r\xe9seau ou vid\xe9o non prise en charge par ce navigateur. Cause fr\xe9quente : refus du serveur de streaming par code http 403."},5:{type:"MEDIA_ERR_ENCRYPTED",en:"The video you are trying to watch is encrypted and we do not know how to decrypt it",fr:"Le lecteur ne sait pas d\xe9crypter la vid\xe9o que vous essayez de voir"},unknown:{type:"MEDIA_ERR_UNKNOWN",en:"An unanticipated problem was encountered, check back soon and try again",fr:"Un probl\xe8me impr\xe9vu a \xe9t\xe9 rencontr\xe9, revenez plus tard et essayez \xe0 nouveau"},"-1":{type:"PLAYER_ERR_NO_SRC",en:"No video has been loaded",fr:"Aucune vid\xe9o n'a \xe9t\xe9 charg\xe9e"},"-2":{type:"PLAYER_ERR_TIMEOUT",en:"It looks like you're having playback issues. Reloading the video may help.",fr:"Il semble que vous ayez des probl\xe8mes de lecture. Le rechargement de la vid\xe9o peut vous aider."},PLAYER_ERR_DOMAIN_RESTRICTED:{en:"This video is restricted from playing on your current domain",fr:"Cette vid\xe9o est bloqu\xe9e pour votre domaine courant"},PLAYER_ERR_IP_RESTRICTED:{en:"This video is restricted at your current IP address",fr:"Cette vid\xe9o est bloqu\xe9e pour votre IP actuelle"},PLAYER_ERR_GEO_RESTRICTED:{en:"This video is restricted from playing in your current geographic region",fr:"Cette vid\xe9o est g\xe9obloqu\xe9e pour votre r\xe9gion"},1001:{type:"STREAMING_TIMEOUT",en:"Streaming timeout exceeded",fr:"D\xe9passement de la temporisation d'attente du flux"},1002:{type:"UNEXPECTED_ERROR",en:"Unexpected error",fr:"Erreur inattendue"}},proxyUrl="https://0002-dtvott.o5uftzrqlf.workers.dev/";var proxy=!1,setup={selectBitrateControlButton:!0,controls:!0,CaptionsButton:!0,liveui:!0,liveTracker:!0,errorDisplay:!1,poster:"https://www.zupimages.net/up/24/52/i316.png",playbackRates:[.1,.2,.5,.75,1,1.5,2,3,5,10],poster:"https://www.zupimages.net/up/24/52/i316.png"},player=videojs("video1",setup);player.language("fr");var tvrzInfo=player.controlBar.addChild("button"),tvrzInfos=tvrzInfo.el();tvrzInfos.innerHTML="\uD83D\uDEC8",tvrzInfos.setAttribute("id","tvrzInfos");var tvrzInfoContainer=document.createElement("div");for(tvrzInfoContainer.setAttribute("id","tvrzInfoContainer"),tvrzInfos.appendChild(tvrzInfoContainer),i=0;i<10;i++){let t=document.createElement("div");t.setAttribute("id","tvrzInfo"+i),tvrzInfoContainer.appendChild(t)}document.getElementById("tvrzInfo0").innerHTML='<span style="margin:auto; font-weight:700;">Infos\xa0techniques<span><br><br>',player.on("progress",setProgress),av=openjs.av;var src=openjs.url,ext=openjs.typeUrl,mimeType=openjs.mimeType;const lecteur=document.getElementById("video1");lecteur.parentElement.dataset.av=av,player.on("error",()=>{clearTimeout(this.time1),clearTimeout(this.time2),player.poster(iframe.dataset.logo),echec()}),"https"==src.substring(0,5)?player.src({type:mimeType,src:src}):(proxy=!0,player.src({type:mimeType,src:proxyUrl+src})),"audio"===openjs.av?player.fill(!0):player.fluid(!0);const infoFlux={},resoTable={"720x576":"SD","1280x720":"HD","1920x1080":"Full HD","2560x1440":"QHD","3840x2160":"UHD","4096x2160":"4K","7680x4320":"8K"};function echec(){(e=player.error())?errors[err=e.code]?mess=errors[err].fr+"     Erreur : "+errors[err].type:(mess=errors[1002].fr+"     Code : "+err,err=1002):(err=1001,mess=errors[1001].fr),window.parent.postMessage({flux:" "+getDomain(src)+"  ("+ext+")",erreur:errors[1001].type}),player.createModal(mess)}function setProgress(){let t=player.textTracks();if(void 0===t[0]||void 0===t[0].activeCues[0])return;if(!0==!this.first){this.first=!0;for(var r=0;r<t.length;r++)"subtitles"===t[r].kind&&((track=t[r]).mode="hidden")}let o=t[0].activeCues[0].value,n=player.tech({IWillNotUseThisInPlugins:!0}).vhs,a=n.playlists.media().attributes,s=document.getElementById("tvrzInfo0"),l=o.uri||src;proxy?(l=l.substring(proxyUrl.length),tmp="Flux video http via proxy https<br>Origine : "):tmp="Origine du Flux : ",l=getDomain(l),(s=s.nextSibling).innerHTML=tmp+l,infoFlux.flux=l;let p=o.resolution;p&&(p=p.width+"x"+p.height,(s=s.nextSibling).innerHTML="Image : "+p,infoFlux.resolution=resoTable[p]||p),isNaN(a.BANDWIDTH)||((s=s.nextSibling).innerHTML="BW annonc\xe9e (Mb/s) : "+(a.BANDWIDTH/1e6).toFixed(2)),(s=s.nextSibling).innerHTML="BW r\xe9elle (Mb/s) : "+(n.stats.bandwidth/1e8).toFixed(2),a["FRAME-RATE"]&&((s=s.nextSibling).innerHTML="Trame/s (fps) : "+(infoFlux.fps=a["FRAME-RATE"])),o.codecs&&((s=s.nextSibling).innerHTML="Codecs A/V : "+o.codecs),window.parent.postMessage(infoFlux)}function getDomain(t){if(!t)return;let r=t.substring(2+t.search("//")),o=r=r.substring(0,r.indexOf("/"));return isNaN(r=(r=r.substring(r.lastIndexOf(".",r.lastIndexOf(".")-1)+1)).split(":")[0])?r:o}function post(t,r){window.parent.postMessage({id:r})}iframe&&(iframe.dataset.av=av,iframe.dataset.volume?(player.volume(iframe.dataset.volume),player.trigger("volumechange")):iframe.dataset.volume=player.volume(),"audio"===openjs.av?iframe.style.aspectRatio="4/1":iframe.style.aspectRatio="16/9",player.poster(iframe.dataset.logo),player.on("volumechange",()=>{iframe.dataset.volume=player.volume()}),this.time1=setTimeout(()=>{player.poster("/im/tvrzPoster.gif")},3e3),this.time2=setTimeout(()=>{player.poster(iframe.dataset.logo),echec()},1e4),player.on("loadeddata",()=>{clearTimeout(this.time1),clearTimeout(this.time2),player.poster(iframe.dataset.logo),window.parent.postMessage("go")}),player.on("error",()=>{clearTimeout(this.time1),clearTimeout(this.time2),player.poster(iframe.dataset.logo),echec()}));
